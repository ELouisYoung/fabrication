### Fabrication ###

Fabrication is an object generation library. It allows you to define Fabricators that are essentially the schematic for objects you want to generate. You can then generate them as needed anywhere in your app or specs.

Currently supported object types are...

* Plain old Ruby objects
* ActiveRecord objects
* Mongoid Documents

By default it will lazily generate active record associations. So if you have a has_many :widgets defined, it will not actually generate the widgets until the association is accessed. You can override this by passing :force => true when defining the field in the Fabricator.

### Installation ###

Add this to your gemfile.

`gem 'fabrication'`

Now you can define fabricators in any of the following locations.

* `spec/fabricators.rb`
* `spec/fabricators/*.rb`

* `test/fabricators.rb`
* `test/fabricators/*.rb`

They are automatically loaded, so no additional requires are necessary.

### Usage ###

Define your fabricators.

    Fabricator(:company) do
      name "Fun Factory"
      employees(:count => 20) { |company, i| Fabricate(:drone, :company => company, :name => "Drone #{i}") }
      location(:force => true) { Fabricate(:location) }
      after_create { |company| company.update_attribute(:ceo, Fabricate(:drone, :name => 'Lead Drone') }
    end

Breaking down the above, we are defining a "company" fabricator, which will generate Company model objects.

* The object has a name field, which is statically filled with "Fun Factory".
* It has a has_many association to employees and will generate an array of 20 records as indicated by the :count => 20. The block is passed the company object being fabricated and index of the array being created.
* It has a belongs_to association to location and this will be generated immediately with the company object. This is because of the :force => true parameter being passed in.
* After the object is created, it will update the "ceo" association with a new "drone" record.

Alternatively, you can Fabricate(:company) without first defining the Fabricator. Doing so will create an empty Fabricator called ":company" and prevent you from defining the Fabricator explicitly later.

### Inheritance ###

So you already have a company fabricator, but you need one that specifically generates an LLC. No problem!

    Fabricator(:llc, :from => :company) do
      type "LLC"
    end

Setting the :from option will inherit the class and all the attributes from the named Fabricator. Even if you haven't defined a :company Fabricator yet, it will still work as long as it references an actual class name.

### Fabricating ###

Now that your Fabricators are defined, you can start generating some objects! To generate the LLC from the previous example, just do this:

    llc = Fabricate(:llc, :name => "Awesome Labs", :location => "Earth")

That will return an instance of the LLC using the fields defined in the Fabricators and overriding with anything passed into Fabricate.

If you need to do something more complex, you can also pass a block to Fabricate. You can use all the features available to you when defining Fabricators, but they only apply to the object generated by this Fabricate call.

    llc = Fabricate(:llc, :name => "Awesome, Inc.") do
      location(:force => true, :count => 2) { Faker::Address.city }
    end

### Contributing ###

I (paulelliott) am actively maintaining this project. If you would like contribute, please fork the project, make your changes on a feature branch, and submit a pull request.

To run rake successfully:

1. Clone the project
2. Install mongodb and sqlite3
3. Install bundler
4. Run `bundle install` from the project root
5. Run `rake` and the test suite should be all green!
